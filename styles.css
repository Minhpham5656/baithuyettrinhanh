:root{
  --bg1:#0b1020;
  --bg2:#111a33;
  --card:#0f1733cc;
  --text:#edf1ff;
  --muted:#b5c1ea;
  --accent:#7a6bff;
  --accent-strong:#5b7cff;
  --ok:#2ddf7b;
  --bad:#ff5e68;
  --warn:#ffcc4d;
  --shadow: 0 16px 44px rgba(3,8,22,.45);
  --shadow-soft: 0 10px 30px rgba(10,12,30,.25);
  --radius: 20px;
  --radius-lg: 26px;
  --glass: rgba(255,255,255,.06);
}
*{box-sizing:border-box}
body{
  margin:0;
  min-height:100vh;
  font-family: "Plus Jakarta Sans", ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
  color:var(--text);
  background:
    radial-gradient(1100px 680px at 15% 10%, rgba(122,107,255,.22), transparent 60%),
    radial-gradient(900px 620px at 80% 0%, rgba(45,223,123,.18), transparent 55%),
    linear-gradient(180deg, #0a0f1f, var(--bg2));
  padding-bottom: 92px;
  line-height: 1.6;
}
.wrap{max-width: 1040px; margin: 0 auto; padding: 28px 18px 0;}

/* Header */
.top{display:flex; gap:16px; align-items:flex-start; justify-content:space-between; flex-wrap:wrap; margin-bottom: 18px;}
.title{display:flex; gap:14px; align-items:center;}
.badge{
  width:52px;height:52px;border-radius:16px;
  background: linear-gradient(135deg, rgba(124,92,255,.9), rgba(45,223,123,.8));
  display:grid;place-items:center;
  box-shadow: var(--shadow);
  font-weight:900; letter-spacing:.6px;
  font-size: 13px;
  text-transform: uppercase;
}
h1{font-size: 22px; margin: 0; line-height: 1.2; letter-spacing:.2px;}
.sub{margin: 6px 0 0; color: var(--muted); font-size: 13.5px;}
.right-tools{display:flex; gap:10px; align-items:center; margin-top: 2px;}
.iconbtn{
  border: 1px solid rgba(255,255,255,.14);
  background: var(--glass);
  color: var(--text);
  border-radius: 14px;
  padding: 10px 12px;
  cursor:pointer;
  box-shadow: var(--shadow-soft);
  transition: transform .15s ease, background .15s ease, border-color .15s ease;
  user-select:none;
}
.iconbtn:hover{ transform: translateY(-1px); background: rgba(255,255,255,.1); border-color: rgba(255,255,255,.22);}
.iconbtn:active{ transform: translateY(0); }

/* Progress */
.progress-card{
  background: linear-gradient(135deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
  border: 1px solid rgba(255,255,255,.12);
  border-radius: var(--radius-lg);
  padding: 14px 16px;
  box-shadow: var(--shadow);
  margin: 16px 0 18px;
}
.progress-line{display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:12px;}
.progress-line .count{font-weight:800; letter-spacing:.2px; font-size: 15px;}
.progress-line .note{color: var(--muted); font-size: 13.5px;}
.bar{
  height: 12px;
  background: rgba(255,255,255,.08);
  border-radius: 999px;
  overflow:hidden;
  border: 1px solid rgba(255,255,255,.1);
}
.bar > div{
  height:100%;
  width:0%;
  background: linear-gradient(90deg, rgba(122,107,255,.95), rgba(45,223,123,.95));
  border-radius: 999px;
  transition: width .35s ease;
}

/* Tags */
.tags{display:flex; gap:10px; flex-wrap:wrap; margin: 10px 0 0;}
.tag{
  padding: 7px 12px;
  border-radius: 999px;
  font-weight:700;
  font-size: 12px;
  letter-spacing:.2px;
  border: 1px solid rgba(255,255,255,.16);
  background: rgba(255,255,255,.06);
}
.tag.type{ border-color: rgba(122,107,255,.55); color: #d9d5ff; }
.tag.skill{ border-color: rgba(45,223,123,.5); color: #c6f7dd; }
.tag.warn{ border-color: rgba(255,204,77,.5); color: #ffeab3; }

/* Main card */
.card{
  background: rgba(15,22,48,.7);
  border: 1px solid rgba(255,255,255,.12);
  border-radius: 24px;
  padding: 18px 18px 16px;
  box-shadow: var(--shadow);
}
.q-head{display:flex; gap:12px; justify-content:space-between; align-items:flex-start; flex-wrap:wrap; margin-bottom: 10px;}
.q-title{font-size: 20px; margin: 0; font-weight:900; letter-spacing:.2px;}
.q-instruction{color: var(--muted); font-size: 13.5px; margin: 6px 0 0; line-height: 1.45;}

.grid{display:grid; gap: 12px; margin-top: 14px;}

/* MCQ */
.answers{display:grid; grid-template-columns: 1fr; gap: 12px;}
@media(min-width:720px){.answers{ grid-template-columns: 1fr 1fr; }}
.answer-card{
  border-radius: 16px;
  padding: 14px 16px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.05);
  box-shadow: 0 12px 28px rgba(6,10,25,.3);
  cursor:pointer;
  transition: transform .15s ease, background .15s ease, border-color .15s ease, box-shadow .15s ease;
  user-select:none;
  font-weight:900;
  letter-spacing:.15px;
  position:relative;
  overflow:hidden;
}
.answer-card:hover{ transform: translateY(-1px); background: rgba(255,255,255,.1); box-shadow: 0 14px 30px rgba(12,16,35,.35);}
.answer-card.selected{border-color: rgba(122,107,255,.7); outline: 2px solid rgba(122,107,255,.22);}
.answer-card.correct{border-color: rgba(45,223,123,.95); outline: 2px solid rgba(45,223,123,.25);}
.answer-card.wrong{border-color: rgba(255,94,104,.95); outline: 2px solid rgba(255,94,104,.22);}

.sentence{
  padding: 16px 16px;
  border-radius: 18px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.06);
  font-weight:900;
  line-height:1.6;
  word-spacing:2px;
}

/* Explain */
.explain{
  margin-top: 14px;
  padding: 14px 14px;
  border-radius: 16px;
  border: 1px dashed rgba(255,255,255,.18);
  background: rgba(6,10,22,.5);
  color: var(--muted);
  font-size: 13.5px;
  line-height: 1.5;
  white-space: pre-wrap;
}

/* Typing */
.inputrow{display:flex; gap: 12px; flex-wrap:wrap; align-items:stretch; margin-top: 12px;}
input[type="text"]{
  flex: 1 1 240px;
  min-height: 50px;
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.05);
  color: var(--text);
  padding: 12px 14px;
  font-size: 15.5px;
  font-weight:800;
  outline:none;
  transition: border-color .15s ease, box-shadow .15s ease;
}
input[type="text"]:focus{
  border-color: rgba(122,107,255,.65);
  box-shadow: 0 0 0 3px rgba(122,107,255,.18);
}
input::placeholder{ color: rgba(234,240,255,.45); font-weight:700; }
.sendbtn{
  flex: 0 0 150px;
  text-align:center;
  font-weight:1000;
  border-radius: 16px;
  padding: 12px 12px;
  cursor:pointer;
  border:none;
  color:white;
  background: linear-gradient(135deg, rgba(122,107,255,.95), rgba(45,223,123,.78));
  transition: transform .15s ease, box-shadow .15s ease;
  box-shadow: 0 12px 30px rgba(12,14,30,.35);
}
.sendbtn:hover{ transform: translateY(-1px); }

.smallnote{margin-top: 8px; color: rgba(234,240,255,.62); font-size: 12.5px;}

/* Drag & Drop */
.blank{
  display:inline-block;
  min-width: 160px;
  padding: 8px 12px;
  border-radius: 14px;
  border: 2px dashed rgba(122,107,255,.55);
  background: rgba(122,107,255,.12);
  vertical-align: middle;
  text-align:center;
  margin: 0 6px;
  transform: translateY(-1px);
}
.blank.filled{border-style: solid; border-color: rgba(255,255,255,.18); background: rgba(0,0,0,.16);}
.token-pool{display:flex; flex-wrap:wrap; gap:10px; margin-top: 12px;}
.token{
  padding: 10px 12px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.16);
  background: rgba(255,255,255,.08);
  font-weight:900;
  cursor:grab;
  user-select:none;
  box-shadow: 0 10px 26px rgba(10,12,30,.3);
}
.token:active{ cursor:grabbing; }

/* Bottom bar */
.bottom{
  position:fixed;
  left:0; right:0; bottom:0;
  padding: 12px 12px;
  background: rgba(8,12,26,.8);
  border-top: 1px solid rgba(255,255,255,.1);
  backdrop-filter: blur(10px);
  z-index: 30;
}
.bottom-inner{
  max-width: 980px;
  margin: 0 auto;
  display:flex;
  gap:10px;
  align-items:center;
}
.bbtn{
  flex:1;
  border-radius: 18px;
  padding: 14px 14px;
  font-weight: 1000;
  letter-spacing: .25px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.08);
  color: var(--text);
  cursor:pointer;
  user-select:none;
  text-align:center;
  transition: transform .15s ease, background .15s ease;
}
.bbtn:hover{ transform: translateY(-1px); background: rgba(255,255,255,.10); }
.bbtn:active{ transform: translateY(0); }
.bbtn.primary{
  background: linear-gradient(135deg, rgba(122,107,255,.95), rgba(45,223,123,.78));
  border:none;
}
.bbtn:disabled{opacity:.45; cursor:not-allowed; transform:none !important;}

/* Confirm modal */
.modal{
  position:fixed; inset:0;
  display:none; place-items:center;
  background: rgba(2,6,18,.6);
  z-index: 50;
  padding: 16px;
}
.modal.show{ display:grid; }
.modal-box{
  width:min(560px, 100%);
  border-radius: 22px;
  background: rgba(15,22,48,.92);
  border: 1px solid rgba(255,255,255,.14);
  box-shadow: 0 20px 70px rgba(0,0,0,.55);
  padding: 18px;
}
.modal-box h3{margin:0 0 6px; font-size: 18px; font-weight: 1000;}
.modal-box p{margin:0 0 12px; color: var(--muted); line-height: 1.45; font-size: 14px;}
.modal-actions{display:flex; gap:10px; flex-wrap:wrap;}
.modal-actions .bbtn{ padding: 12px 12px; }

/* Toolbox drawer */
.drawer{
  position:fixed; top: 0; right: 0; height: 100%;
  width: min(420px, 92vw);
  background: rgba(10,14,28,.94);
  border-left: 1px solid rgba(255,255,255,.1);
  box-shadow: -20px 0 70px rgba(0,0,0,.45);
  transform: translateX(105%);
  transition: transform .25s ease;
  z-index: 60;
  padding: 16px;
}
.drawer.show{ transform: translateX(0%); }
.drawer h3{margin: 0 0 6px; font-size: 18px; font-weight: 1000;}
.drawer .muted{ color: var(--muted); font-size: 13px; line-height:1.45; }
.spinbox{
  margin-top: 14px;
  border-radius: 22px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.06);
  padding: 16px;
  box-shadow: var(--shadow);
  text-align:center;
}
.number{
  font-size: 64px;
  font-weight: 1000;
  letter-spacing: 1px;
  margin: 8px 0;
  background: linear-gradient(135deg, rgba(122,107,255,1), rgba(45,223,123,1));
  -webkit-background-clip:text;
  background-clip:text;
  color: transparent;
}
.invite{font-weight: 900; margin-top: 6px; color: rgba(234,240,255,.9);}

/* Fullscreen Gate Overlay */
#fsGate{
  position:fixed; inset:0; z-index:9999;
  display:grid; place-items:center;
  background: radial-gradient(1000px 700px at 20% 20%, rgba(122,107,255,.25), transparent 55%),
              radial-gradient(900px 650px at 80% 30%, rgba(45,223,123,.18), transparent 50%),
              rgba(0,0,0,.55);
  backdrop-filter: blur(10px);
  padding:24px;
  text-align:center;
}
.fsbox{
  width:min(620px, 96vw);
  border-radius: 26px;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(15,22,48,.75);
  box-shadow: 0 30px 90px rgba(0,0,0,.6);
  padding: 20px 18px;
}
.fsbox .big{
  font-size: 20px;
  font-weight: 1000;
  margin: 2px 0 6px;
}
.fsbox .desc{
  color: rgba(234,240,255,.78);
  line-height: 1.55;
  margin: 0 0 12px;
  font-size: 14px;
}
.fsbox .row{
  display:flex; gap:10px; flex-wrap:wrap; justify-content:center;
  margin-top: 10px;
}
.startbtn{
  font-size: 16px;
  font-weight: 1000;
  cursor:pointer;
  border:none;
  border-radius: 18px;
  padding: 14px 16px;
  color:white;
  background: linear-gradient(135deg,#7a6bff,#2ddf7b);
  min-width: 240px;
  transition: transform .15s ease;
  user-select:none;
}
.startbtn:hover{ transform: translateY(-1px); }
.ghostbtn{
  font-size: 14px;
  font-weight: 900;
  cursor:pointer;
  border-radius: 18px;
  padding: 14px 16px;
  border: 1px solid rgba(255,255,255,.18);
  background: rgba(255,255,255,.06);
  color: white;
  min-width: 240px;
  user-select:none;
}
.tiny{margin-top: 10px; color: rgba(234,240,255,.5); font-size: 11px; text-align:center;}

@media (max-width: 640px){
  .wrap{padding: 20px 14px 0;}
  .badge{width:46px;height:46px;border-radius:14px;}
  h1{font-size: 20px;}
  .card{padding: 16px;}
  .progress-card{padding: 12px 14px;}
  .bottom-inner{flex-direction: column;}
  .bbtn{width: 100%;}
  .sendbtn{flex: 1 1 100%;}
  .inputrow{flex-direction: column;}
  .answer-card{font-size: 14px;}
}

/* Animations */
@keyframes pop {0%{transform:scale(1)}45%{transform:scale(1.04)}100%{transform:scale(1)}}
@keyframes shake {0%{transform:translateX(0)}20%{transform:translateX(-8px)}40%{transform:translateX(8px)}60%{transform:translateX(-6px)}80%{transform:translateX(6px)}100%{transform:translateX(0)}}
.pop{ animation: pop .35s ease; }
.shake{ animation: shake .35s ease; }
